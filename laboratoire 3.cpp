#include <iostream>
#include <cstdlib>
#include <ctime>
#include <iomanip>
using namespace std;

const int N = 8;  // Вы можете выбрать 6, 8 или 10

// Прототипы
void показатьМатрицу(int (*матрица)[N]);
void заполнитьСпиралью(int (*матрица)[N]);
void заполнитьЗигзагомВертикально(int (*матрица)[N]);
void повернутьГраницы(int (*матрица)[N]);
void поменятьДиагонали(int (*матрица)[N]);
void транспонировать(int (*матрица)[N]);
void поменятьКвадранты(int (*матрица)[N]);
void сортировкаШейкером(int *начало, int *конец);
void операцииСМатрицей(int (*матрица)[N], char операция, int значение);

int main() {
    srand(time(0));
    int матрица[N][N];
    
    cout << "=== ПРАКТИЧЕСКАЯ РАБОТА №3 ===" << endl;
    cout << "Матрица " << N << "x" << N << endl << endl;
    
    // 1. Заполнение по выбранной схеме
    cout << "1. ЗАПОЛНЕНИЕ СПИРАЛЬЮ:" << endl;
    заполнитьСпиралью(матрица);
    показатьМатрицу(матрица);
    
    cout << "\n2. ЗАПОЛНЕНИЕ ВЕРТИКАЛЬНЫМ ЗИГЗАГОМ:" << endl;
    заполнитьЗигзагомВертикально(матрица);
    показатьМатрицу(матрица);
    
    // 2. Перестановка по выбранной схеме
    cout << "\n3. ПОВОРОТ ГРАНИЦ:" << endl;
    повернутьГраницы(матрица);
    показатьМатрицу(матрица);
    
    cout << "\n4. ОБМЕН ДИАГОНАЛЕЙ:" << endl;
    поменятьДиагонали(матрица);
    показатьМатрицу(матрица);
    
    // 3. Сортировка
    cout << "\n5. СОРТИРОВКА ШЕЙКЕРОМ:" << endl;
    сортировкаШейкером(&матрица[0][0], &матрица[0][0] + N*N - 1);
    показатьМатрицу(матрица);
    
    // 4. Математические операции
    cout << "\n6. УМНОЖЕНИЕ НА 2:" << endl;
    операцииСМатрицей(матрица, '*', 2);
    показатьМатрицу(матрица);
    
    return 0;
}

// ============ ОПРЕДЕЛЕНИЯ ФУНКЦИЙ ============

void показатьМатрицу(int (*матрица)[N]) {
    for(int i = 0; i < N; i++) {
        for(int j = 0; j < N; j++) {
            cout << setw(4) << *(*(матрица + i) + j) << " ";
        }
        cout << endl;
    }
}

void заполнитьСпиралью(int (*матрица)[N]) {
    int значение = 1;
    int верх = 0, низ = N-1, лево = 0, право = N-1;
    
    while(верх <= низ && лево <= право) {
        // → (верх, лево → право)
        for(int j = лево; j <= право; j++) {
            *(*(матрица + верх) + j) = значение++;
        }
        верх++;
        
        // ↓ (право, верх → низ)
        for(int i = верх; i <= низ; i++) {
            *(*(матрица + i) + право) = значение++;
        }
        право--;
        
        // ← (низ, право → лево)
        if(верх <= низ) {
            for(int j = право; j >= лево; j--) {
                *(*(матрица + низ) + j) = значение++;
            }
            низ--;
        }
        
        // ↑ (лево, низ → верх)
        if(лево <= право) {
            for(int i = низ; i >= верх; i--) {
                *(*(матрица + i) + лево) = значение++;
            }
            лево++;
        }
    }
}

void заполнитьЗигзагомВертикально(int (*матрица)[N]) {
    int значение = 1;
    
    for(int j = 0; j < N; j++) {
        if(j % 2 == 0) {
            // Четная колонка: верх → низ
            for(int i = 0; i < N; i++) {
                *(*(матрица + i) + j) = значение++;
            }
        } else {
            // Нечетная колонка: низ → верх
            for(int i = N-1; i >= 0; i--) {
                *(*(матрица + i) + j) = значение++;
            }
        }
    }
}

void повернутьГраницы(int (*матрица)[N]) {
    // Сохранить левый верхний угол
    int временная = *(*(матрица + 0) + 0);
    
    // Верх → Право (сдвиг влево)
    for(int j = 0; j < N-1; j++) {
        *(*(матрица + 0) + j) = *(*(матрица + 0) + (j+1));
    }
    
    // Право → Низ (сдвиг вверх)
    for(int i = 0; i < N-1; i++) {
        *(*(матрица + i) + (N-1)) = *(*(матрица + (i+1)) + (N-1));
    }
    
    // Низ ← Лево (сдвиг вправо)
    for(int j = N-1; j > 0; j--) {
        *(*(матрица + (N-1)) + j) = *(*(матрица + (N-1)) + (j-1));
    }
    
    // Лево ↑ Верх (сдвиг вниз, кроме первого)
    for(int i = N-1; i > 1; i--) {
        *(*(матрица + i) + 0) = *(*(матрица + (i-1)) + 0);
    }
    
    // Поместить сохраненный угол
    *(*(матрица + 1) + 0) = временная;
}

void поменятьДиагонали(int (*матрица)[N]) {
    for(int i = 0; i < N; i++) {
        for(int j = 0; j < N; j++) {
            // Если на главной диагонали (i == j)
            if(i == j) {
                int *д1 = *(матрица + i) + j;           // Главная диагональ
                int *д2 = *(матрица + i) + (N-1-j);     // Побочная диагональ
                swap(*д1, *д2);
            }
        }
    }
}

void транспонировать(int (*матрица)[N]) {
    for(int i = 0; i < N; i++) {
        for(int j = i+1; j < N; j++) {
            int *a = *(матрица + i) + j;
            int *b = *(матрица + j) + i;
            swap(*a, *b);
        }
    }
}

void поменятьКвадранты(int (*матрица)[N]) {
    int половина = N / 2;
    
    // Поменять A (левый верх) и D (правый низ)
    for(int i = 0; i < половина; i++) {
        for(int j = 0; j < половина; j++) {
            int *a = *(матрица + i) + j;
            int *d = *(матрица + (i+половина)) + (j+половина);
            swap(*a, *d);
        }
    }
    
    // Поменять B (правый верх) и C (левый низ)
    for(int i = 0; i < половина; i++) {
        for(int j = половина; j < N; j++) {
            int *b = *(матрица + i) + j;
            int *c = *(матрица + (i+половина)) + (j-половина);
            swap(*b, *c);
        }
    }
}

void сортировкаШейкером(int *начало, int *конец) {
    bool обмен;
    int *лево = начало;
    int *право = конец;
    
    do {
        обмен = false;
        
        // Лево → право
        for(int *p = лево; p < право; p++) {
            if(*p > *(p + 1)) {
                swap(*p, *(p + 1));
                обмен = true;
            }
        }
        право--;
        
        // Право → лево
        for(int *p = право; p > лево; p--) {
            if(*p < *(p - 1)) {
                swap(*p, *(p - 1));
                обмен = true;
            }
        }
        лево++;
        
    } while(обмен && лево <= право);
}

void операцииСМатрицей(int (*матрица)[N], char операция, int значение) {
    for(int i = 0; i < N; i++) {
        for(int j = 0; j < N; j++) {
            int *элемент = *(матрица + i) + j;
            
            switch(операция) {
                case '+': *элемент += значение; break;
                case '-': *элемент -= значение; break;
                case '*': *элемент *= значение; break;
                case '/': 
                    if(значение != 0) *элемент /= значение; 
                    else cout << "Ошибка: деление на ноль!" << endl;
                    break;
            }
        }
    }
}